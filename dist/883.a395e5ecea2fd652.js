"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[883],{5883:(M,A,r)=>{r.r(A),r.d(A,{PaiementsModule:()=>P});var p=r(6895),g=r(8492),T=r(6270),b=r(7590),f=r(4763),c=r(4006),_=r(1366),t=r(4650),C=r(529),q=r(4932);let U=(()=>{class n{constructor(a,e){this.http=a,this.token=e,this.base_url="https://back-m1p10mean.onrender.com/paiements/"}getAll(){return this.http.get(this.base_url+"liste")}valider(a){const{nom:e,prenom:l,email:u}=this.token.GetUser();return this.http.post(this.base_url+"validation",{data:{valideur:{nom:e,prenom:l,email:u},paiement_id:a}})}}return n.\u0275fac=function(a){return new(a||n)(t.LFG(C.eN),t.LFG(q.B))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=r(4631);function s(n,o){1&n&&(t.TgZ(0,"span",16),t._uU(1,"Loading..."),t.qZA())}const d=function(n){return["/paiements/etat/",n]};function i(n,o){if(1&n&&(t.TgZ(0,"tr")(1,"th",17),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ngb-highlight",18),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ngb-highlight",18),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ngb-highlight",18),t.qZA(),t.TgZ(9,"td")(10,"a",19),t._uU(11,"D\xe9tails"),t.qZA()()()),2&n){const a=o.$implicit,e=t.oxw();t.xp6(2),t.Oqu(a.client.nom),t.xp6(2),t.Q6J("result",a.reparateur.nom)("term",e.tableService.searchTerm),t.xp6(2),t.Q6J("result",a.voiture.numero)("term",e.tableService.searchTerm),t.xp6(2),t.Q6J("result",a.voiture.marque)("term",e.tableService.searchTerm),t.xp6(2),t.Q6J("routerLink",t.VKq(8,d,a._id))}}let v=(()=>{class n{constructor(a,e){this.paiementService=a,this.tableService=e,this.paiements=[],this.loading=!1}ngOnInit(){this.getAll(),this.tableService._setData(this.paiements),this.tableService._init(),this._reparations$=this.tableService.reparations$,this.total$=this.tableService.total$}getAll(){this.paiementService.getAll().subscribe({next:a=>{this.paiements=a.data.paiements}})}onSort({column:a,direction:e}){this.headers.forEach(l=>{l.sortable!==a&&(l.direction="")}),this.tableService.sortColumn=a,this.tableService.sortDirection=e}}return n.\u0275fac=function(a){return new(a||n)(t.Y36(U),t.Y36(f.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-liste"]],viewQuery:function(a,e){if(1&a&&t.Gf(b.j,5),2&a){let l;t.iGM(l=t.CRH())&&(e.headers=l)}},standalone:!0,features:[t._Bn([f.i,p.JJ]),t.jDz],decls:39,vars:19,consts:[[1,"row"],[1,"col-xl-12"],["cardTitle","Listes des r\xe9paration","blockClass","table-border-style",3,"options"],[1,"mb-3","row"],["for","table-complete-search",1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","table-complete-search","type","text","name","searchTerm",1,"form-control",3,"ngModel","ngModelChange"],["class","col col-form-label",4,"ngIf"],[1,"table","table-striped"],["scope","col"],["scope","col","sortable","",3,"sort"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","p-2"],[3,"collectionSize","page","pageSize","pageChange"],["name","pageSize",1,"form-select",2,"width","auto",3,"ngModel","ngModelChange"],[3,"ngValue"],[1,"col","col-form-label"],["scope","row"],[3,"result","term"],[1,"label","theme-bg2","text-white","f-12","rounded-pill",3,"routerLink"]],template:function(a,e){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-card",2)(3,"form")(4,"div",3)(5,"label",4),t._uU(6,"Recherche par nom client :"),t.qZA(),t.TgZ(7,"div",5)(8,"input",6),t.NdJ("ngModelChange",function(u){return e.tableService.searchTerm=u}),t.qZA()(),t.YNc(9,s,2,0,"span",7),t.ALo(10,"async"),t.qZA(),t.TgZ(11,"table",8)(12,"thead")(13,"tr")(14,"th",9),t._uU(15,"Client"),t.qZA(),t.TgZ(16,"th",10),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(17," Reparateur "),t.qZA(),t.TgZ(18,"th",10),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(19,"Voiture"),t.qZA(),t.TgZ(20,"th",10),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(21,"Marque"),t.qZA()()(),t.TgZ(22,"tbody"),t.YNc(23,i,12,10,"tr",11),t.ALo(24,"async"),t.qZA()(),t.TgZ(25,"div",12)(26,"ngb-pagination",13),t.NdJ("pageChange",function(u){return e.tableService.page=u}),t.ALo(27,"async"),t.qZA(),t.TgZ(28,"select",14),t.NdJ("ngModelChange",function(u){return e.tableService.pageSize=u}),t.TgZ(29,"option",15),t._uU(30,"5"),t.qZA(),t.TgZ(31,"option",15),t._uU(32,"10"),t.qZA(),t.TgZ(33,"option",15),t._uU(34,"20"),t.qZA(),t.TgZ(35,"option",15),t._uU(36,"30"),t.qZA(),t.TgZ(37,"option",15),t._uU(38,"40"),t.qZA()()()()()()()),2&a&&(t.xp6(2),t.Q6J("options",!1),t.xp6(6),t.Q6J("ngModel",e.tableService.searchTerm),t.xp6(1),t.Q6J("ngIf",t.lcZ(10,13,e.tableService.loading$)),t.xp6(14),t.Q6J("ngForOf",t.lcZ(24,15,e._reparations$)),t.xp6(3),t.Q6J("collectionSize",t.lcZ(27,17,e.total$))("page",e.tableService.page)("pageSize",e.tableService.pageSize),t.xp6(2),t.Q6J("ngModel",e.tableService.pageSize),t.xp6(1),t.Q6J("ngValue",5),t.xp6(2),t.Q6J("ngValue",10),t.xp6(2),t.Q6J("ngValue",20),t.xp6(2),t.Q6J("ngValue",30),t.xp6(2),t.Q6J("ngValue",40))},dependencies:[T.m,p.sg,p.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.On,c.F,S.A,_.N9,_._h,p.Ov,p.ez,c.u5,b.j,_.ZS,_.jF,g.Bz,g.rH]}),n})();var m=r(8858),Z=r(1195);function E(n,o){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA()()),2&n){const a=o.$implicit;t.xp6(2),t.Oqu(a.cause),t.xp6(2),t.Oqu(a.solution),t.xp6(2),t.hij("",t.lcZ(7,4,a.prix)," Ar"),t.xp6(3),t.Oqu(a.etat)}}function h(n,o){1&n&&t._UZ(0,"span",17)}const J=[{path:"",children:[{path:"liste",component:v},{path:"etat/:id",component:(()=>{class n{constructor(a,e,l,u){this.reparationsService=a,this.paiementService=e,this.route=l,this.toast=u,this.loading=!1,this.total=0}ngOnInit(){this.etat()}etat(){this.loading=!0,this.route.params.subscribe(a=>{this.reparationsService.detailReparation(a.id).subscribe(e=>{1==e.success&&(this.loading=!1,this.reparation=e.data.reparation,this.setTotal())})})}setTotal(){this.reparation.reparation_faire.forEach(a=>{this.total+=Number(a.prix)})}valider(){this.loading=!0,this.paiementService.valider(this.reparation.paiement._id).subscribe({next:a=>{a.success&&(this.loading=!1,this.toast.ShowSuccess("Paiements",a.message.toString()))},error:a=>{this.loading=!1,this.toast.ShowError("Paiements",a.toString())}})}}return n.\u0275fac=function(a){return new(a||n)(t.Y36(m.L),t.Y36(U),t.Y36(g.gz),t.Y36(Z.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-etat"]],standalone:!0,features:[t.jDz],decls:127,vars:39,consts:[[1,"row"],[1,"col-lg-4","col-sm-12"],["cardTitle","Client","blockClass","table-border-style",3,"options"],[1,"container-info-vehicule"],[1,"label"],[1,"col-lg-3","col-sm-12"],["cardTitle","Voiture","blockClass","table-border-style",3,"options"],[1,"col-lg-5","col-sm-12"],["cardTitle","D\xe9tails","blockClass","table-border-style",3,"options"],[1,"col"],["cardTitle","Listes des r\xe9paration","blockClass","table-border-style",3,"options"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-responsive"],[4,"ngFor","ngForOf"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["cardTitle","Paiements","blockClass","table-border-style",3,"options"],[1,"label","theme-bg2","text-white","f-12","rounded-pill",3,"click"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(a,e){1&a&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"app-card",2)(4,"div",3)(5,"p")(6,"span",4),t._uU(7,"Nom : "),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.qZA()(),t._UZ(10,"hr"),t.TgZ(11,"p")(12,"span",4),t._uU(13,"Pr\xe9nom : "),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.qZA()(),t._UZ(16,"hr"),t.TgZ(17,"p")(18,"span",4),t._uU(19,"Email : "),t.qZA(),t.TgZ(20,"span"),t._uU(21),t.qZA()()()()(),t.TgZ(22,"div",5)(23,"app-card",6)(24,"div",3)(25,"p")(26,"span",4),t._uU(27,"Num\xe9ro : "),t.qZA(),t.TgZ(28,"span"),t._uU(29),t.qZA()(),t._UZ(30,"hr"),t.TgZ(31,"p")(32,"span",4),t._uU(33,"Marque : "),t.qZA(),t.TgZ(34,"span"),t._uU(35),t.qZA()(),t._UZ(36,"hr"),t.TgZ(37,"p")(38,"span",4),t._uU(39,"Model : "),t.qZA(),t.TgZ(40,"span"),t._uU(41),t.qZA()()()()(),t.TgZ(42,"div",7)(43,"app-card",8)(44,"div",3)(45,"div",3)(46,"p")(47,"span",4),t._uU(48,"Date de d\xe9p\xf4t : "),t.qZA(),t.TgZ(49,"span"),t._uU(50),t.ALo(51,"date"),t.ALo(52,"date"),t.qZA()(),t.TgZ(53,"p")(54,"span",4),t._uU(55,"Date de sortie : "),t.qZA(),t.TgZ(56,"span"),t._uU(57),t.ALo(58,"date"),t.ALo(59,"date"),t.qZA()(),t.TgZ(60,"p")(61,"span",4),t._uU(62,"Montant total : "),t.qZA(),t.TgZ(63,"span"),t._uU(64),t.ALo(65,"number"),t.qZA()(),t.TgZ(66,"p")(67,"span",4),t._uU(68," \xc9tat des r\xe9parations : "),t.qZA(),t.TgZ(69,"span"),t._uU(70),t.qZA()()()()()()(),t.TgZ(71,"div",0)(72,"div",9)(73,"app-card",10)(74,"div",0)(75,"div",11)(76,"table",12)(77,"thead")(78,"tr")(79,"th"),t._uU(80,"Cause"),t.qZA(),t.TgZ(81,"th"),t._uU(82,"Solution"),t.qZA(),t.TgZ(83,"th"),t._uU(84,"Prix"),t.qZA(),t.TgZ(85,"th"),t._uU(86,"Etat"),t.qZA()()(),t.TgZ(87,"tbody"),t.YNc(88,E,10,6,"tr",13),t.qZA(),t.TgZ(89,"tfoot")(90,"tr"),t._UZ(91,"td"),t.TgZ(92,"td"),t._uU(93,"Total"),t.qZA(),t.TgZ(94,"td"),t._uU(95),t.ALo(96,"number"),t.qZA(),t._UZ(97,"td"),t.qZA()()()()(),t.YNc(98,h,1,0,"span",14),t.qZA()()(),t.TgZ(99,"div",0)(100,"div",9)(101,"app-card",15)(102,"div",0)(103,"div",11)(104,"table",12)(105,"thead")(106,"tr")(107,"th"),t._uU(108,"Date paiement"),t.qZA(),t.TgZ(109,"th"),t._uU(110,"Montant"),t.qZA(),t.TgZ(111,"th"),t._uU(112,"Mode"),t.qZA(),t.TgZ(113,"th"),t._uU(114,"Actions"),t.qZA()()(),t.TgZ(115,"tbody")(116,"tr")(117,"td"),t._uU(118),t.qZA(),t.TgZ(119,"td"),t._uU(120),t.ALo(121,"number"),t.qZA(),t.TgZ(122,"td"),t._uU(123),t.qZA(),t.TgZ(124,"td")(125,"button",16),t.NdJ("click",function(){return e.valider()}),t._uU(126," Valider "),t.qZA()()()()()()()()()()()),2&a&&(t.xp6(3),t.Q6J("options",!1),t.xp6(6),t.hij("",e.reparation.client.nom," "),t.xp6(6),t.hij("",e.reparation.client.prenom," "),t.xp6(6),t.hij("",e.reparation.client.email," "),t.xp6(2),t.Q6J("options",!1),t.xp6(6),t.hij("",e.reparation.voiture.numero," "),t.xp6(6),t.hij("",e.reparation.voiture.marque," "),t.xp6(6),t.hij("",e.reparation.voiture.model," "),t.xp6(2),t.Q6J("options",!1),t.xp6(7),t.AsE("",t.lcZ(51,23,e.reparation.date_depot)," - ",t.xi3(52,25,e.reparation.date_depot,"shortTime")," "),t.xp6(7),t.AsE("",t.lcZ(58,28,e.reparation.date_sortie)," - ",t.xi3(59,30,e.reparation.date_sortie,"shortTime")," "),t.xp6(7),t.hij("",t.lcZ(65,33,e.total)," Ar"),t.xp6(6),t.hij("",e.reparation.status," "),t.xp6(3),t.Q6J("options",!0),t.xp6(15),t.Q6J("ngForOf",e.reparation.reparation_faire),t.xp6(7),t.hij("",t.lcZ(96,35,e.total)," Ar"),t.xp6(3),t.Q6J("ngIf",e.loading),t.xp6(3),t.Q6J("options",!0),t.xp6(17),t.Oqu(e.reparation.paiement.date),t.xp6(2),t.hij("",t.lcZ(121,37,e.reparation.paiement.recu)," Ar"),t.xp6(3),t.Oqu(e.reparation.paiement.mode))},dependencies:[T.m,p.sg,p.O5,S.A,p.JJ,p.uU,p.ez]}),n})()}],canActivate:[r(8332).L]}];let O=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.Bz.forChild(J),g.Bz]}),n})(),P=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,O]}),n})()},4763:(M,A,r)=>{r.d(A,{i:()=>S});var p=r(1135),g=r(7579),T=r(8505),b=r(8372),f=r(3900),c=r(1005),_=r(9646),t=r(4650);let S=(()=>{class s{constructor(){this._loading$=new p.X(!0),this._search$=new g.x,this._reparations$=new p.X([]),this._total$=new p.X(0),this.reparations=[],this._state={page:1,pageSize:4,searchTerm:"",sortColumn:"",sortDirection:""}}_init(){this._search$.pipe((0,T.b)(()=>this._loading$.next(!0)),(0,b.b)(200),(0,f.w)(()=>this._search()),(0,c.g)(200),(0,T.b)(()=>this._loading$.next(!1))).subscribe(i=>{this._reparations$.next(i.reparations),this._total$.next(i.total)}),this._search$.next()}_setData(i){this.reparations=i}_search(){const{sortColumn:i,sortDirection:v,pageSize:m,page:Z,searchTerm:E}=this._state;let h=function q(s,d,i){return""===i||""===d?s:[...s].sort((v,m)=>{const Z=((s,d)=>s<d?-1:s>d?1:0)(v[d],m[d]);return"asc"===i?Z:-Z})}(this.reparations,i,v);h=h.filter(L=>function U(s,d){return s.includes(d)}(L.client.nom,E));const x=h.length;return h=h.slice((Z-1)*m,(Z-1)*m+m),(0,_.of)({reparations:h,total:x})}get reparations$(){return this._reparations$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}_set(i){Object.assign(this._state,i),this._search$.next()}set page(i){this._set({page:i})}set pageSize(i){this._set({pageSize:i})}set searchTerm(i){this._set({searchTerm:i})}set sortColumn(i){this._set({sortColumn:i})}set sortDirection(i){this._set({sortDirection:i})}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()}}]);